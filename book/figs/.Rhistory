dat.wf $ rank <- ordered(dat.wf $ rank, levels =
c("新人", "９級", "８級", "７級", "６級", "５級", "４級", "３級",
"２級", "１級", "初段", "二段", "三段", "四段", "五段", "六段",
"七段", "八段", "九段", "十段", "天鳳"))
dat.cr $ rank <- ordered(dat.cr $ rank, levels =
c("新人", "９級", "８級", "７級", "６級", "５級", "４級", "３級",
"２級", "１級", "初段", "二段", "三段", "四段", "五段", "六段",
"七段", "八段", "九段", "十段", "天鳳"))
cbgFillPalette <- scale_colour_manual(values=c("#ca0020", "#0571b0"))
# red <- "#ca0020"; blue <- "#0571b0"; green <- "#4daf4a"
# Graphical summary (overall)
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1.5)
g <- g + geom_point(size=3, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("rate")
g <- g + theme(legend.position=c(.8, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
g
g <- g + theme(legend.position=c(.8, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text.y = element_text(angle = 90))
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1.5)
g <- g + geom_point(size=3, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("rate")
g <- g + theme(legend.position=c(.8, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text.y = element_text(angle = 90))
g
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1.5)
g <- g + geom_point(size=3, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("rate")
g <- g + theme(legend.position=c(.8, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text.y = element_text(angle = 90, hjust = 1))
g
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1.5)
g <- g + geom_point(size=3, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("rate")
g <- g + theme(legend.position=c(.8, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text.y = element_text(angle = 90, vjust = 1))
g
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1.5)
g <- g + geom_point(size=3, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("rate")
g <- g + theme(legend.position=c(.8, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text.y = element_text(angle = 90, vjust = .6))
g
axis.text.x
?axis.text.x
?theme
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1.5)
g <- g + geom_point(size=3, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("rate")
g <- g + theme(legend.position=c(.8, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text.y = element_text(angle = 90, vjust = .5))
g
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1.5)
g <- g + geom_point(size=3, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("rate")
g <- g + theme(legend.position=c(.8, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, hjust = .5)) +
theme(axis.text.y = element_text(angle = 90, vjust = .5))
g
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1.5)
g <- g + geom_point(size=3, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("rate")
g <- g + theme(legend.position=c(.8, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, hjust = 0)) +
theme(axis.text.y = element_text(angle = 90, vjust = .5))
g
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1.5)
g <- g + geom_point(size=3, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("rate")
g <- g + theme(legend.position=c(.8, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = 0)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1.5)
g <- g + geom_point(size=3, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("rate")
g <- g + theme(legend.position=c(.8, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g
g <- g + scale_y_continuous(name="")
g
theme_set(theme_bw(base_family="HiraKakuProN-W3"))
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1)
g <- g + geom_point(size=2.5, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("") + ylab("rate")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g <- g + scale_y_continuous(name="")
g
theme_set(theme_bw(base_family="HiraKakuProN-W3"))
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1)
g <- g + geom_point(size=2.5, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("") + ylab("rate")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
g
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1.5)
g <- g + geom_point(size=3, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("rate")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g <- g + scale_y_continuous(name="")
g
quartz(type="pdf", file="stats_wf.pdf", width = 5, height = 4)
theme_set(theme_bw(base_family="HiraKakuProN-W3"))
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1)
g <- g + geom_point(size=2.5, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("") + ylab("")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g <- g + scale_y_continuous(name="")
g
dev.off()
quartz(type="pdf", file="stats_cr.pdf", width = 5, height = 4)
theme_set(theme_bw(base_family="HiraKakuProN-W3"))
g <- ggplot(data = dat.cr,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1)
g <- g + geom_point(size=2.5, fill="white")  +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("") + ylab("")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g <- g + scale_y_continuous(name="")
g
dev.off()
quartz(type="pdf", file="stats_wf.pdf", width = 4.8, height = 4.2)
theme_set(theme_bw(base_family="HiraKakuProN-W3"))
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1)
g <- g + geom_point(size=2.5, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("") + ylab("")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g <- g + scale_y_continuous(name="")
g
dev.off()
quartz(type="pdf", file="stats_cr.pdf", width = 4.8, height = 4.2)
theme_set(theme_bw(base_family="HiraKakuProN-W3"))
g <- ggplot(data = dat.cr,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1)
g <- g + geom_point(size=2.5, fill="white")  +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("") + ylab("")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g <- g + scale_y_continuous(name="")
g
dev.off()
##-------------------------------------------------------------------------
## R code for graphics in Riichi Book
## Author: Daina Chiba
## Last modified: 2015-10-11
##-------------------------------------------------------------------------
library(foreign)
library(ggplot2)
old = theme_set(theme_bw(base_family="HiraKakuProN-W3"))
# data
dat <- read.dta("ratestats2015-12.dta")
dat $ rank <- ordered(dat $ rank, levels =
c("新人", "９級", "８級", "７級", "６級", "５級", "４級", "３級",
"２級", "１級", "初段", "二段", "三段", "四段", "五段", "六段",
"七段", "八段", "九段", "十段", "天鳳"))
dat.1 <- dat[c("rank", "win")]
dat.2 <- dat[c("rank", "feed")]
dat.3 <- dat[c("rank", "call")]
dat.4 <- dat[c("rank", "riichi")]
names(dat.1)[names(dat.1)=="win"] <- "rate"
dat.1 $ stats <- "win"
dat.1 $ graph <- "Win / Feed"
names(dat.2)[names(dat.2)=="feed"] <- "rate"
dat.2 $ stats <- "feed"
dat.2 $ graph <- "Win / Feed"
names(dat.3)[names(dat.3)=="call"] <- "rate"
dat.3 $ stats <- "call"
dat.3 $ graph <- "Call / Riichi"
names(dat.4)[names(dat.4)=="riichi"] <- "rate"
dat.4 $ stats <- "riichi"
dat.4 $ graph <- "Call / Riichi"
dat.wf <- rbind(dat.1, dat.2)
dat.cr <- rbind(dat.3, dat.4)
dat.wf $ rank <- ordered(dat.wf $ rank, levels =
c("新人", "９級", "８級", "７級", "６級", "５級", "４級", "３級",
"２級", "１級", "初段", "二段", "三段", "四段", "五段", "六段",
"七段", "八段", "九段", "十段", "天鳳"))
dat.cr $ rank <- ordered(dat.cr $ rank, levels =
c("新人", "９級", "８級", "７級", "６級", "５級", "４級", "３級",
"２級", "１級", "初段", "二段", "三段", "四段", "五段", "六段",
"七段", "八段", "九段", "十段", "天鳳"))
cbgFillPalette <- scale_colour_manual(values=c("#ca0020", "#0571b0"))
# red <- "#ca0020"; blue <- "#0571b0"; green <- "#4daf4a"
# Graphical summary (overall)
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1.5)
g <- g + geom_point(size=3, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("rate")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g <- g + scale_y_continuous(name="")
g
quartz(type="pdf", file="stats_wf.pdf", width = 4.8, height = 4.2)
theme_set(theme_bw(base_family="HiraKakuProN-W3"))
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1)
g <- g + geom_point(size=2.5, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("Rate")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g <- g + scale_y_continuous(name="")
g
dev.off()
quartz(type="pdf", file="stats_cr.pdf", width = 4.8, height = 4.2)
theme_set(theme_bw(base_family="HiraKakuProN-W3"))
g <- ggplot(data = dat.cr,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1)
g <- g + geom_point(size=2.5, fill="white")  +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("Rate")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g <- g + scale_y_continuous(name="")
g
dev.off()
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1.5)
g <- g + geom_point(size=3, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("rate")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g <- g + scale_y_continuous(name="")
g
quartz(type="pdf", file="stats_wf.pdf", width = 4.8, height = 4.2)
theme_set(theme_bw(base_family="HiraKakuProN-W3"))
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1)
g <- g + geom_point(size=2.5, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("Rate")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g
dev.off()
quartz(type="pdf", file="stats_cr.pdf", width = 4.8, height = 4.2)
theme_set(theme_bw(base_family="HiraKakuProN-W3"))
g <- ggplot(data = dat.cr,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1)
g <- g + geom_point(size=2.5, fill="white")  +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("Rate")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g
dev.off()
quartz(type="pdf", file="stats_wf.pdf", width = 4.8, height = 4.2)
theme_set(theme_bw(base_family="HiraKakuProN-W3"))
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1)
g <- g + geom_point(size=2.5, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Player rank") + ylab("Ratio")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g
dev.off()
quartz(type="pdf", file="stats_cr.pdf", width = 4.8, height = 4.2)
theme_set(theme_bw(base_family="HiraKakuProN-W3"))
g <- ggplot(data = dat.cr,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1)
g <- g + geom_point(size=2.5, fill="white")  +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Player rank") + ylab("Ratio")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g
dev.off()
##-------------------------------------------------------------------------
## R code for graphics in Riichi Book
## Author: Daina Chiba
## Last modified: 2015-10-11
##-------------------------------------------------------------------------
library(foreign)
library(ggplot2)
old = theme_set(theme_bw(base_family="HiraKakuProN-W3"))
# data
dat <- read.dta("ratestats2015-12.dta")
dat $ rank <- ordered(dat $ rank, levels =
c("新人", "９級", "８級", "７級", "６級", "５級", "４級", "３級",
"２級", "１級", "初段", "二段", "三段", "四段", "五段", "六段",
"七段", "八段", "九段", "十段", "天鳳"))
dat.1 <- dat[c("rank", "win")]
dat.2 <- dat[c("rank", "feed")]
dat.3 <- dat[c("rank", "call")]
dat.4 <- dat[c("rank", "riichi")]
names(dat.1)[names(dat.1)=="win"] <- "rate"
dat.1 $ stats <- "win"
dat.1 $ graph <- "Win / Feed"
names(dat.2)[names(dat.2)=="feed"] <- "rate"
dat.2 $ stats <- "feed"
dat.2 $ graph <- "Win / Feed"
names(dat.3)[names(dat.3)=="call"] <- "rate"
dat.3 $ stats <- "call"
dat.3 $ graph <- "Call / Riichi"
names(dat.4)[names(dat.4)=="riichi"] <- "rate"
dat.4 $ stats <- "riichi"
dat.4 $ graph <- "Call / Riichi"
dat.wf <- rbind(dat.1, dat.2)
dat.cr <- rbind(dat.3, dat.4)
dat.wf $ rank <- ordered(dat.wf $ rank, levels =
c("新人", "９級", "８級", "７級", "６級", "５級", "４級", "３級",
"２級", "１級", "初段", "二段", "三段", "四段", "五段", "六段",
"七段", "八段", "九段", "十段", "天鳳"))
dat.cr $ rank <- ordered(dat.cr $ rank, levels =
c("新人", "９級", "８級", "７級", "６級", "５級", "４級", "３級",
"２級", "１級", "初段", "二段", "三段", "四段", "五段", "六段",
"七段", "八段", "九段", "十段", "天鳳"))
cbgFillPalette <- scale_colour_manual(values=c("#ca0020", "#0571b0"))
# red <- "#ca0020"; blue <- "#0571b0"; green <- "#4daf4a"
# Graphical summary (overall)
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1.5)
g <- g + geom_point(size=3, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("rate")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g <- g + scale_y_continuous(name="")
g
quartz(type="pdf", file="stats_wf.pdf", width = 4.8, height = 4.2)
theme_set(theme_bw(base_family="HiraKakuProN-W3"))
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1)
g <- g + geom_point(size=2.5, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Player rank") + ylab("Hand-level statistics")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g
dev.off()
quartz(type="pdf", file="stats_cr.pdf", width = 4.8, height = 4.2)
theme_set(theme_bw(base_family="HiraKakuProN-W3"))
g <- ggplot(data = dat.cr,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1)
g <- g + geom_point(size=2.5, fill="white")  +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Player rank") + ylab("Hand-level statistics")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g
dev.off()
##-------------------------------------------------------------------------
## R code for graphics in Riichi Book
## Author: Daina Chiba
## Last modified: 2015-10-11
##-------------------------------------------------------------------------
library(foreign)
library(ggplot2)
old = theme_set(theme_bw(base_family="HiraKakuProN-W3"))
# data
dat <- read.dta("ratestats2015-12.dta")
dat $ rank <- ordered(dat $ rank, levels =
c("新人", "９級", "８級", "７級", "６級", "５級", "４級", "３級",
"２級", "１級", "初段", "二段", "三段", "四段", "五段", "六段",
"七段", "八段", "九段", "十段", "天鳳"))
dat.1 <- dat[c("rank", "win")]
dat.2 <- dat[c("rank", "feed")]
dat.3 <- dat[c("rank", "call")]
dat.4 <- dat[c("rank", "riichi")]
names(dat.1)[names(dat.1)=="win"] <- "rate"
dat.1 $ stats <- "win"
dat.1 $ graph <- "Win / Feed"
names(dat.2)[names(dat.2)=="feed"] <- "rate"
dat.2 $ stats <- "feed"
dat.2 $ graph <- "Win / Feed"
names(dat.3)[names(dat.3)=="call"] <- "rate"
dat.3 $ stats <- "call"
dat.3 $ graph <- "Call / Riichi"
names(dat.4)[names(dat.4)=="riichi"] <- "rate"
dat.4 $ stats <- "riichi"
dat.4 $ graph <- "Call / Riichi"
dat.wf <- rbind(dat.1, dat.2)
dat.cr <- rbind(dat.3, dat.4)
dat.wf $ rank <- ordered(dat.wf $ rank, levels =
c("新人", "９級", "８級", "７級", "６級", "５級", "４級", "３級",
"２級", "１級", "初段", "二段", "三段", "四段", "五段", "六段",
"七段", "八段", "九段", "十段", "天鳳"))
dat.cr $ rank <- ordered(dat.cr $ rank, levels =
c("新人", "９級", "８級", "７級", "６級", "５級", "４級", "３級",
"２級", "１級", "初段", "二段", "三段", "四段", "五段", "六段",
"七段", "八段", "九段", "十段", "天鳳"))
cbgFillPalette <- scale_colour_manual(values=c("#ca0020", "#0571b0"))
# red <- "#ca0020"; blue <- "#0571b0"; green <- "#4daf4a"
# Graphical summary (overall)
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1.5)
g <- g + geom_point(size=3, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Rank") + ylab("rate")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g <- g + scale_y_continuous(name="")
g
quartz(type="pdf", file="stats_wf.pdf", width = 4.8, height = 4.2)
theme_set(theme_bw(base_family="HiraKakuProN-W3"))
g <- ggplot(data = dat.wf,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1)
g <- g + geom_point(size=2.5, fill="white") + expand_limits(y=c(.1, .25)) +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Player rank") + ylab("Average rates")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g
dev.off()
quartz(type="pdf", file="stats_cr.pdf", width = 4.8, height = 4.2)
theme_set(theme_bw(base_family="HiraKakuProN-W3"))
g <- ggplot(data = dat.cr,
aes(x = rank, y = rate, group = stats, shape = stats, colour = stats))
g <- g + geom_line(aes(linetype = stats), size = 1)
g <- g + geom_point(size=2.5, fill="white")  +
scale_shape_manual(name = "stats", values=c(22,21)) +
scale_linetype_discrete(name="stats") + xlab("Player rank") + ylab(" ")
g <- g + theme(legend.position=c(.9, .5)) + cbgFillPalette +
theme(axis.text.x = element_text(angle = 90, vjust = .5)) +
theme(axis.text.y = element_text(angle = 90, hjust = .5))
g
dev.off()
